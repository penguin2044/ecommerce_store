<div class="container">
  <h1>Into the Music - Musical Instruments & Accessories</h1>
  <!-- Search Bar -->
   <div class="search-container">
    <%= form_with url: root_path, method: :get, class: "search-form" do %>
      <%= text_field_tag :search, params[:search],
          placeholder: "Search for instruments, brands, or keywords...",
          class: "search-input" %>
      <%= submit_tag "Search", class: "search-btn" %>

      <% if params[:search].present? %>
        <%= link_to "Clear Search", root_path, class: "clear-search-btn" %>
      <% end %>
    <% end %>
  </div>

  <!-- Search Results Info -->
  <% if @search_query.present? %>
    <div class="search-results-info">
      <p>Found <%= pluralize(@products.count, 'product') %> matching "<strong><%= @search_query %></strong>"</p>
    </div>
  <% end %>

  <!-- Category Navigation -->
  <div class="category-nav">
    <%= link_to 'All Products', root_path, class: @category.nil? ? 'category-link active' : 'category-link' %>
    <% @categories.each do |category| %>
      <%= link_to category.name, root_path(category_id: category.id), class: @category == category ? 'category-link active' : 'category-link' %>
    <% end %>
  </div>

  <!-- Category Title -->
  <% if @category %>
    <h2 class="category-title"><%= @category.name %></h2>
    <p class="category-description"><%= @category.description %></p>
  <% end %>

  <!-- Products Grid -->
  <div class="products-grid">
    <% if @products.any? %>
      <% @products.each do |product| %>
        <div class="product-card">
          <h3><%= link_to product.name, product_path(product) %></h3>
          <p class="category"><%= product.category.name %></p>
          <p class="description"><%= truncate(product.description, length: 100) %></p>
          <p class="price">
            <% if product.on_sale? %>
              <span class="original-price">$<%= number_with_precision(product.price, precision: 2) %></span>
              <span class="sale-price">$<%= number_with_precision(product.sale_price, precision: 2) %></span>
            <% else %>
              $<%= number_with_precision(product.price, precision: 2) %>
            <% end %>
          </p>
          <%= link_to 'View Details', product_path(product), class: 'btn' %>
        </div>
      <% end %>
    <% else %>
      <p class="no-products">No products found in this category.</p>
    <% end %>
  </div>
</div>